<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Market Mirror - Live Data</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
        
        :root {
            --bg-primary: #000000; --bg-secondary: #0f0f0f; --bg-tertiary: #1a1a1a;
            --accent-green: #00ff41; --accent-green-dark: #009929; --text-primary: #00ff41;
            --text-secondary: #66ff66; --text-dim: #339933; --border-primary: #00ff41;
            --border-secondary: #339933; --danger-red: #ff0040; --warning-yellow: #ffff00; --info-blue: #4a90e2;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Poppins', sans-serif; background: var(--bg-primary); color: var(--text-primary); min-height: 100vh; }
        .container { max-width: 1800px; margin: 0 auto; padding: 20px; }
        .header { text-align: center; margin-bottom: 15px; padding: 20px 0; border-bottom: 1px solid var(--border-primary); background: var(--bg-secondary); }
        .title { font-size: 3.5rem; font-weight: 700; margin-bottom: 10px; }
        .subtitle { font-size: 1.3rem; color: var(--text-secondary); }
        .timeline-container { background: var(--bg-secondary); padding: 15px 20px; margin-bottom: 30px; border: 1px solid var(--border-secondary); text-align: center; }
        .timeline-container label { font-size: 1rem; font-weight: 500; margin-right: 15px; }
        #timeline-scrubber { width: 50%; accent-color: var(--accent-green); }
        #timeline-date { display: inline-block; width: 200px; font-weight: 600; color: var(--accent-green); letter-spacing: 1px; }
        .controls { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px; margin-bottom: 30px; padding: 20px; background: var(--bg-secondary); border: 1px solid var(--border-secondary); }
        .control-btn { background: var(--bg-tertiary); border: 1px solid var(--border-secondary); color: var(--text-primary); padding: 12px 20px; cursor: pointer; font-weight: 500; font-size: 0.9rem; transition: all 0.2s ease; text-transform: uppercase; }
        .control-btn:disabled { opacity: 0.6; cursor: not-allowed; }
        .control-btn:hover:not(:disabled) { background: var(--bg-secondary); border-color: var(--border-primary); opacity: 1; }
        .control-btn.active { background: var(--accent-green-dark); border-color: var(--border-primary); color: var(--bg-primary); opacity: 1; }
        .main-grid { display: grid; grid-template-columns: 1fr 500px; gap: 20px; margin-bottom: 30px; }
        .dashboard-section { background: var(--bg-secondary); border: 1px solid var(--border-secondary); padding: 20px; }
        .section-title { font-size: 1.2rem; font-weight: 600; color: var(--text-primary); margin-bottom: 20px; padding-bottom: 10px; border-bottom: 1px solid var(--border-secondary); text-transform: uppercase; }
        .dashboard-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 20px; }
        .sentiment-card { background: var(--bg-tertiary); border: 1px solid var(--border-secondary); padding: 20px; transition: all 0.2s ease; position: relative; }
        .sentiment-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 2px; background: var(--accent-green); }
        .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px solid var(--border-secondary); }
        .card-title { font-size: 1rem; font-weight: 600; }
        .category-tag { padding: 4px 12px; font-size: 0.7rem; font-weight: 600; border: 1px solid var(--border-secondary); text-transform: uppercase; color: var(--text-dim); }
        .metric-row { display: flex; justify-content: space-between; align-items: center; padding: 6px 0; border-bottom: 1px solid rgba(51, 153, 51, 0.2); }
        .metric-row:last-child { border-bottom: none; }
        .metric-name, .metric-value { font-size: 0.85rem; color: var(--text-dim); }
        .price { font-weight: 600; font-size: 0.95rem; color: var(--text-primary); }
        .change { padding: 3px 6px; font-size: 0.8rem; font-weight: 500; border: 1px solid; }
        .positive { color: var(--accent-green); border-color: var(--accent-green); }
        .negative { color: var(--danger-red); border-color: var(--danger-red); }
        .neutral { color: var(--text-dim); border-color: var(--text-dim); }
        .status-indicator { width: 8px; height: 8px; margin-left: 8px; border-radius: 50%;}
        .bullish { background: var(--accent-green); } .bearish { background: var(--danger-red); } .neutral-status { background: var(--warning-yellow); }
        .sidebar { display: flex; flex-direction: column; gap: 20px; }
        .chart-container { height: 300px; background: var(--bg-tertiary); border: 1px solid var(--border-secondary); margin-top: 15px; position: relative; }
        .news-chart-container { height: 50px; margin-top: 4px; }
        .loading { display: flex; justify-content: center; align-items: center; height: 80px; font-size: 1rem; }
        .loading::after { content: ''; width: 16px; height: 16px; border: 2px solid var(--border-secondary); border-top: 2px solid var(--accent-green); border-radius: 50%; margin-left: 10px; animation: spin 1s linear infinite; }
        @keyframes spin { 100% { transform: rotate(360deg); } }
        .executive-summary { background: var(--bg-tertiary); border: 1px solid var(--border-primary); padding: 15px; margin-top: 10px; }
        .summary-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
        .summary-status { padding: 6px 12px; border: 1px solid; font-weight: 600; font-size: 0.8rem; }
        .summary-bullish { background: var(--accent-green-dark); color: var(--bg-primary); border-color: var(--accent-green); }
        .summary-bearish { background: var(--danger-red); color: var(--bg-primary); border-color: var(--danger-red); }
        .summary-neutral { background: var(--bg-primary); color: var(--warning-yellow); border-color: var(--warning-yellow); }
        .summary-text { font-size: 0.85rem; line-height: 1.5; color: var(--text-secondary); }
        .news-item { background: var(--bg-tertiary); border: 1px solid var(--border-secondary); padding: 10px; margin-bottom: 8px; font-size: 0.8rem; }
        .news-title a { color: var(--text-primary); font-weight: 500; text-decoration: none; }
        .news-title a:hover { text-decoration: underline; }
        .news-time { color: var(--text-dim); font-size: 0.7rem; margin-top: 4px; }
        .last-updated { text-align: center; margin-top: 20px; color: var(--text-dim); font-size: 0.85rem; padding: 8px; border: 1px solid var(--border-secondary); background: var(--bg-secondary); }
        .time-controls { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; margin-bottom: 12px; }
        .time-btn { background: var(--bg-tertiary); border: 1px solid var(--border-secondary); color: var(--text-dim); padding: 6px; cursor: pointer; font-size: 0.75rem; transition: all 0.2s ease; }
        .time-btn:hover, .time-btn.active { background: var(--accent-green-dark); color: var(--bg-primary); border-color: var(--border-primary); }
        .error { background: rgba(255, 0, 64, 0.1); border: 1px solid var(--danger-red); color: var(--danger-red); padding: 12px; margin: 8px 0; text-align: center; }
        .symbol-select { width: 100%; background: var(--bg-tertiary); border: 1px solid var(--border-secondary); color: var(--text-primary); padding: 8px; font-size: 0.85rem; margin-bottom: 15px; }
        .signals-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 15px; margin-bottom: 40px; }
        .signal-card { background-color: var(--bg-tertiary); border-left: 4px solid; padding: 15px; }
        .signal-card.critical { border-color: var(--danger-red); }
        .signal-card.warning { border-color: var(--warning-yellow); }
        .signal-card.opportunity { border-color: var(--accent-green); }
        .signal-card.info { border-color: var(--info-blue); }
        .signal-title { font-weight: 600; font-size: 1rem; color: var(--text-primary); margin-bottom: 5px; }
        .signal-desc { font-size: 0.85rem; color: var(--text-secondary); line-height: 1.5; }
        .signal-action { font-size: 0.8rem; color: var(--text-dim); margin-top: 10px; padding-top: 10px; border-top: 1px solid var(--border-secondary); font-style: italic; }
        .signal-action::before { content: 'Action: '; font-weight: 600; font-style: normal; color: var(--text-secondary); }
        .site-footer { text-align: center; padding: 20px; margin-top: 20px; border-top: 1px solid var(--border-secondary); color: var(--text-dim); font-size: 0.85rem; }
        .site-footer p { margin: 4px 0; }
        .signals-library { display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 15px; margin-bottom: 40px; }
        .library-card { background-color: var(--bg-tertiary); border: 1px solid var(--border-secondary); padding: 15px; position: relative; opacity: 0.6; transition: opacity 0.2s ease, border-color 0.2s ease; }
        .library-card:hover { opacity: 1; }
        .library-card .signal-title { font-size: 0.9rem; color: var(--text-secondary); }
        .library-card .signal-desc { font-size: 0.8rem; color: var(--text-dim); line-height: 1.4; }
        .library-card .status-dot { position: absolute; top: 18px; right: 15px; width: 10px; height: 10px; border-radius: 50%; background-color: #555; border: 1px solid #777; }
        .library-card .status-dot.active { background-color: var(--accent-green); box-shadow: 0 0 8px var(--accent-green); border-color: #fff; }
        .library-card.active-card { opacity: 1; border-color: var(--border-primary); }
        .signal-tooltip { position: absolute; display: none; background-color: #1f1f1f; border: 1px solid var(--border-primary); padding: 15px; z-index: 1000; max-width: 400px; pointer-events: none; font-size: 0.85rem; border-radius: 4px; box-shadow: 0 4px 15px rgba(0, 255, 65, 0.2); line-height: 1.5; }
        .signal-tooltip h4 { font-size: 1rem; color: var(--text-primary); margin-top: 0; margin-bottom: 8px; border-bottom: 1px solid var(--border-secondary); padding-bottom: 8px; }
        .signal-tooltip p { margin-bottom: 12px; color: var(--text-secondary); }
        .signal-tooltip code { display: block; background-color: var(--bg-primary); padding: 8px; border: 1px solid var(--border-secondary); border-radius: 3px; color: var(--warning-yellow); font-family: 'Courier New', Courier, monospace; font-size: 0.8rem; white-space: pre-wrap; word-wrap: break-word; }
        .signal-tooltip .tooltip-section-title { font-weight: 600; color: var(--text-dim); margin-top: 12px; margin-bottom: 5px; text-transform: uppercase; font-size: 0.7rem; letter-spacing: 0.5px; }

        /* --- NEW COLLAPSIBLE STYLES --- */
        .collapsible {
            cursor: pointer;
            position: relative;
            transition: background-color 0.2s ease;
            -webkit-tap-highlight-color: transparent; /* For mobile */
        }
        .collapsible:hover {
            background-color: #111;
        }
        .collapsible::after {
            content: '+';
            font-size: 1.2em;
            font-weight: bold;
            color: var(--text-dim);
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            transition: transform 0.3s ease;
        }
        .collapsible.active::after {
            content: 'âˆ’'; /* Minus sign */
        }
        .collapsible-content {
            overflow: hidden;
            max-height: 0;
            transition: max-height 0.4s ease-out;
        }

        @media (max-width: 1200px) { .main-grid { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1 class="title">MARKET MIRROR</h1>
            <p class="subtitle">Live & Historical Market Intelligence</p>
        </header>

        <div class="timeline-container">
            <label for="timeline-scrubber">Historical View:</label>
            <input type="range" id="timeline-scrubber" min="0" max="90" value="90">
            <span id="timeline-date">TODAY (LIVE)</span>
        </div>

        <div class="controls">
            <button class="control-btn active" id="btn-all">All Markets</button>
            <button class="control-btn" id="btn-global">Global Indices</button>
            <button class="control-btn" id="btn-india">Indian Markets</button>
            <button class="control-btn" id="btn-library">Signal Library</button>
            <button class="control-btn" id="refresh-btn">Refresh Data</button>
            <button class="control-btn" id="autorefresh-btn">Auto-Refresh: ON</button>
        </div>
        <main class="main-grid">
            <section class="dashboard-section">
                <h2 class="section-title collapsible active">Active Signals</h2>
                <div class="collapsible-content">
                    <div class="signals-grid" id="signalsGrid"><div class="loading"></div></div>
                    <div class="signals-library" id="signalsLibrary" style="display: none;"></div>
                </div>
                
                <h2 class="section-title collapsible active" id="matrix-title" style="margin-top: 40px;">Market Data Matrix</h2>
                <div class="collapsible-content">
                    <div class="dashboard-grid" id="dashboardGrid"><div class="loading"></div></div>
                </div>
            </section>
            <aside class="sidebar">
                <div class="dashboard-section">
                    <h2 class="section-title collapsible active">Chart Analysis</h2>
                    <div class="collapsible-content">
                        <select class="symbol-select" id="chartSymbolSelect"></select>
                        <div class="time-controls">
                            <button class="time-btn active" id="btn-1d">1D</button>
                            <button class="time-btn" id="btn-5d">5D</button>
                            <button class="time-btn" id="btn-1m">1M</button>
                            <button class="time-btn" id="btn-3m">3M</button>
                        </div>
                        <div class="chart-container" id="priceChartContainer"></div>
                        <div class="news-chart-container" id="newsChartContainer"></div>
                    </div>
                </div>
                <div class="dashboard-section" id="news-panel">
                    <h2 class="section-title collapsible active" id="news-title">Live Business News</h2>
                    <div class="collapsible-content">
                        <div id="newsContainer"></div>
                    </div>
                </div>
                <div class="dashboard-section">
                    <h2 class="section-title collapsible active" id="summary-title">Executive Summary</h2>
                    <div class="collapsible-content">
                        <div class="executive-summary" id="executiveSummary"></div>
                    </div>
                </div>
            </aside>
        </main>
        <footer class="last-updated" id="lastUpdated"></footer>
        <footer class="site-footer">
            <p>Made by Sid Parida</p>
            <p>&copy; 2025 Market Mirror. All Rights Reserved.</p>
        </footer>
        
        <div id="signal-tooltip" class="signal-tooltip"></div>

    </div>
</body>
</html>